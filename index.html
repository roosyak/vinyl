<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Виниловые пластинки Апатиты Кировск</title>
	<link rel="icon" href="favicon.ico" />
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
	<script src="collection.js"></script>
	<style>
		.rub {
			font-size: 1.5em;
			background: #fff49b;
			border-radius: .3em;
			padding: 0 .3em;
			color: #444;
		}

		.rub::after {
			content: "руб.";
			margin-left: .3em;
			font-size: .6em;
		}

		img {
			margin: 0 0 .5em 0;
			min-height: 100px;
		}

		.item {
			float: left;
			width: 200px;
			height: 330px;
			overflow: auto;
			margin: 0 .5em .5em 0;
		}

		p {
			max-width: 90%;
			margin: 0;
			padding: 0;
			font-size: .9em;
		}

		.prs {
			text-align: center;
			margin-top: -1.7em;
		}

		.genres font {
			font-size: .9em;
			color: #777;
		}

		.genres font::after {
			content: ", ";
		}

		.genres font:last-of-type:after {
			content: "";
		}

		.sortorder:after {
			content: "\25b2";
		}

		.sortorder.reverse:after {
			content: "\25bc";
		}

		.sortBy {
			margin-bottom: 1em;
		}

		.sortBy::after {
			content: "";
			clear: both;
			display: block;
		}

		.sortBy button {
			margin: 0 .1em;
		}
	</style>
</head>

<body>
	<div ng-app="vnl" ng-controller="customersCtrl">
		<div class="sortBy">
			Сортировать пластинки по
			<!-- {{propertyName}}; reverse = {{reverse}}  -->

			<button ng-click="sortBy('artist')">
				Исполнителям
				<span class="sortorder" ng-show="propertyName === 'artist'" ng-class="{reverse: reverse}"></span>
			</button>

			<button ng-click="sortBy('title')">Альбомам
				<span class="sortorder" ng-show="propertyName === 'title'" ng-class="{reverse: reverse}"></span>
			</button>

			<button ng-click="sortBy('folder')">Цене
				<span class="sortorder" ng-show="propertyName === 'folder'" ng-class="{reverse: reverse}"></span>
			</button>

			<button ng-click="sortBy('released')">Годам
				<span class="sortorder" ng-show="propertyName === 'released'" ng-class="{reverse: reverse}"></span>
			</button>
		</div>

		<div ng-repeat="x in list | orderBy:propertyName:reverse" class="item">
			<a href="{{ x.uri}}" target="_blank">
				<img src="{{x.thumb}}">
			</a>
			<div class="prs">
				<font class="rub">{{ x.folder }}</font>
			</div>
			<p>
				<a href="{{ x.uri}}" target="_blank">{{ x.tittle }}</a>
				<br>
				{{ x.artist }}
			</p>
			{{ +x.released > 0 ? x.released + ' г.' : ''}}
			<p class="genres">
				<font ng-repeat="g in x.genres">{{g}}</font>
				<font ng-repeat="s in x.styles">{{s}}</font>
			</p>
		</div>
	</div>
	<script>
		Vinyls.forEach(e => {
			e.released = +e.released;
			e.folder = e.notes ? +e.notes : +e.folder;
		});
		var app = angular.module('vnl', []);
		app.controller('customersCtrl', function ($scope, $http) {
			$scope.list = Vinyls;
			$scope.propertyName = 'artist';
			$scope.reverse = false;

			$scope.sortBy = function (propertyName) {
				$scope.reverse = ($scope.propertyName === propertyName) ? !$scope.reverse : false;
				$scope.propertyName = propertyName;
			};
		});
	</script>
</body>

</html>